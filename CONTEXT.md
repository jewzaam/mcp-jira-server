# MCP JIRA Server - Project Context

## Project Overview
A read-only Model Context Protocol (MCP) server that provides AI assistants with tools to search and retrieve JIRA issues. Integrates with AI tools like Claude Desktop, VS Code, and other MCP-compatible clients.

## Current Status
- **All unit tests passing** (102 tests) ✅
- **9 MCP tools implemented** ✅
- **7/9 tools working reliably** ✅
- **2 tools with known issues** (get_children, get_descendants) ⚠️
- **Comprehensive test coverage** ✅
- **Active production use** - Used for ~1 month with JIRA v9.12.26

## Quick Start
```bash
# Setup environment
make setup

# Run tests
make test

# Check status
make status

# Run server (requires config)
make run-server
```

## Key Files & Structure
```
mcp-jira-server/
├── Makefile                    # Main development commands
├── mcp_jira_server/
│   ├── server.py              # Main MCP server implementation
│   ├── config.py              # Configuration management
│   └── test_*.py              # Comprehensive test suite
├── jira_extractor/
│   └── client.py              # JIRA API client
├── example_mcp_jira_server.yaml # Example configuration
└── requirements.txt           # Dependencies
```

## Available MCP Tools
1. `search_issues` - Search JIRA using JQL or text
2. `get_issue` - Get detailed issue information
3. `identifier_hint` - Help with JIRA issue key format
4. `get_issue_relationships` - Get all relationships for an issue
5. `get_descendants` - Traverse down the issue hierarchy
6. `get_children` - Get immediate children only
7. `get_linked_issues` - Get horizontally linked issues
8. `get_parent` - Get immediate parent issue
9. `get_ancestors` - Traverse up the issue hierarchy

## Development Commands
```bash
make help              # Show all available commands
make setup             # Create venv and install deps
make test              # Run all tests with linting
make test-all          # Run tests without linting
make coverage          # Generate coverage report
make lint              # Run code linting
make clean             # Clean up environment
make status            # Show project status
```

## Configuration
Create `mcp_jira_server.yaml`:
```yaml
url: https://your-jira-instance.com
username: your-username
token: your-api-token
```

## Known Issues
- **get_children and get_descendants tools**: Request timeouts due to inefficient queries
- **Root cause**: Complex relationship traversal queries are too slow for JIRA API
- **Current workaround**: Using MCP server without these 2 problematic tools
- **Future work**: Simplify approach for relationship traversal (workaround exists in stale branches)

## Architecture
- **MCP Server**: FastMCP-based server with 9 tools
- **JIRA Client**: REST API client with authentication support
- **Field Discovery**: Dynamic parent field discovery with TTL caching
- **Relationship Tools**: Comprehensive hierarchy traversal

## Development Workflow
- **Git branch management:** Always work on feature branches, never directly on main
- **Commit attribution:** Include "Assisted-by: [tool-name] ([model-name])" in commit messages for AI-assisted work
- **Source attribution:** Include "Generated by: [tool-name] ([model-name])" comments in new source files created with AI assistance
- **Proper git workflow:** Before suggesting pushes, ensure on feature branch, fetch latest main, commit changes, rebase on main, then push to feature branch using "-u" option

## Testing & Security
- **Unit tests:** Must run without real credentials, no JIRA instance dependency
- **Integration tests:** Can test against JIRA but without authentication
- **Development workflow:** Update code → deploy locally → test via MCP tool directly
- **Security requirement:** LLMs never get authentication credentials
- **Config approach:** JSON config files with tokens (working well for single user)
- **Target JIRA version:** v9.12.26 (tested and working)